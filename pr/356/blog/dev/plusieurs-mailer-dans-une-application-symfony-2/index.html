<!DOCTYPE html>
<html lang="fr" class="no-js">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Plusieurs mailer dans une application Symfony 2</title>

        <!-- Favicon -->
        <link rel="apple-touch-icon" sizes="180x180" href="/elao_/pr/356/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/elao_/pr/356/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/elao_/pr/356/favicon-16x16.png">
        <link rel="manifest" href="/elao_/pr/356/site.webmanifest">
        <link rel="mask-icon" href="/elao_/pr/356/safari-pinned-tab.svg" color="#ff4344">
        <link rel="shortcut icon" href="/elao_/pr/356/favicon.ico">
        <meta name="msapplication-TileColor" content="#ff4344">
        <meta name="msapplication-config" content="/elao_/pr/356/browserconfig.xml">
        <meta name="theme-color" content="#ffffff">

                    <meta name="description" content="Plusieurs mailer dans une application Symfony 2" />
            <link rel="canonical" href="https://elao.github.io/elao_/pr/356/blog/dev/plusieurs-mailer-dans-une-application-symfony-2" />

            <!-- Open Graph / Facebook -->
            <meta property="og:title" content="Plusieurs mailer dans une application Symfony 2" />
            <meta property="og:locale" content="fr" />
            <meta property="og:description" content="Plusieurs mailer dans une application Symfony 2" />
            <meta property="og:url" content="https://elao.github.io/elao_/pr/356/blog/dev/plusieurs-mailer-dans-une-application-symfony-2" />
            <meta property="og:site_name" content="elao_" />
                                        <meta property="og:image" content="/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/720c584a0ad8c98caf0314104c24a9e9.jpg">
            
            <!-- Twitter -->
            <meta property="twitter:card" content="summary_large_image">
            <meta property="twitter:title" content="Plusieurs mailer dans une application Symfony 2">
            <meta property="twitter:description" content="Plusieurs mailer dans une application Symfony 2">
            <meta property="twitter:site" content="@elao">
            <meta property="twitter:creator" content="@elao">
                                        <meta property="twitter:image" content="https://elao.github.io/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/0c40a78fca70f6f3af04ef70944d3f42.jpg">
                    
                            <meta name="robots" content="noindex" />
        
        <script>
                        document.querySelector('html').classList.remove('no-js');
        </script>

                    <link rel="stylesheet" href="/elao_/pr/356/build/app.78b573b9.css">
        
        <script src="/elao_/pr/356/build/runtime.571404d0.js" defer></script><script src="/elao_/pr/356/build/40.6bb9d388.js" defer></script><script src="/elao_/pr/356/build/app.8e45e17b.js" defer></script>

            </head>
    <body>
        <header class="header">
            <div class="container">
                                    <!--
                        Todo :
                        - only on homepage : on scroll .logo.logo--animated becomes .logo.logo--animated.logo--active (triggers its animation)
                     -->
                    <a href="/elao_/pr/356/">
                        <span class="screen-reader">Plusieurs mailer dans une application Symfony 2</span>
                                                    <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                                            </a>
                
                                    <!-- Desktop nav -->
                    <nav class="nav">
                        <ul>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/nos-services">
                                                                                <span>Services</span>
                                    </a>
                                </li>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/methodologie">
                                                                                <span>Méthodologie</span>
                                    </a>
                                </li>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/etudes-de-cas">
                                                                                <span>Études de cas</span>
                                    </a>
                                </li>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/nos-valeurs">
                                                                                <span>Valeurs</span>
                                    </a>
                                </li>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/la-tribu">
                                                                                <span>La tribu</span>
                                    </a>
                                </li>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/blog">
                                                                                <span>Blog</span>
                                    </a>
                                </li>
                                                            <li class="nav__item">
                                    <a href="/elao_/pr/356/contact">
                                                                                    <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                <span>Contact</span>
                                    </a>
                                </li>
                                                    </ul>
                    </nav>
                
                                    <!-- Mobile nav -->
                    <nav class="nav-mobile">
                        <div class="nav-mobile__header">
                            <a href="/elao_/pr/356/">
                                                            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" viewBox="0 0 300 100" class="logo logo--animated">
                                <path d="M61.6,61.6H19.7C21,69,24.8,72.2,32.6,72.2c5.9,0,8.8-1.9,11.7-7.8l16.1,6.9C56.2,82,46.9,87.8,32.1,87.8
                                    c-19.1,0-32-12.6-32-31.6c0-19.5,12.6-32.6,31.4-32.6c18.1,0,30.3,12.6,30.3,31.6C61.7,57.2,61.7,58.9,61.6,61.6z M19.6,49.3h23.6
                                    c-0.2-7.9-4.1-10.9-11.3-10.9S20.7,41.8,19.6,49.3z"/>
                                <path d="M71.2,0.1H90v86.5H71.2V0.1z"/>
                                <path d="M166.1,24.7v61.8h-18.8V72.7c-3.5,9.8-10.5,15.1-20.4,15.1c-17.7,0-27.4-12.9-27.4-32
                                    c0-19.4,9.3-32.2,26.2-32.2c10.5,0,18,5.4,21.6,15.6V24.7H166.1z M147.9,55.7c0-10.4-4.8-15.2-15.1-15.2c-9.9,0-14.6,4.8-14.6,15.2
                                    c0,10.1,4.7,14.9,14.6,14.9C143.1,70.7,147.9,65.9,147.9,55.7L147.9,55.7z"/>
                                <path d="M242.8,55.8c0,19.9-15.3,32-33.6,32s-33.6-12.1-33.6-32s15.3-32.2,33.6-32.2S242.8,35.8,242.8,55.8z M224,55.8
                                    c0-10.4-4.7-15.2-14.8-15.2c-10.1,0-14.8,4.8-14.8,15.2c0,10.1,4.7,14.9,14.8,14.9S224,65.9,224,55.8L224,55.8z"/>
                                <rect x="243.1" y="86.5" width="56.7" height="15"/>
                            </svg>
                        
                            </a>
                            <button class="nav-toggle nav-toggle--close">
                                <i class="icon icon--close" aria-hidden="true"></i>
                                <span class="screen-reader">Fermer le menu</span>
                            </button>
                        </div>
                        <ul>
                                                            <li class="nav-mobile__item ">
                                    <a href="/elao_/pr/356/nos-services">
                                                                                <span>Services</span>
                                    </a>
                                </li>
                                                            <li class="nav-mobile__item ">
                                    <a href="/elao_/pr/356/methodologie">
                                                                                <span>Méthodologie</span>
                                    </a>
                                </li>
                                                            <li class="nav-mobile__item ">
                                    <a href="/elao_/pr/356/etudes-de-cas">
                                                                                <span>Études de cas</span>
                                    </a>
                                </li>
                                                            <li class="nav-mobile__item ">
                                    <a href="/elao_/pr/356/nos-valeurs">
                                                                                <span>Valeurs</span>
                                    </a>
                                </li>
                                                            <li class="nav-mobile__item ">
                                    <a href="/elao_/pr/356/la-tribu">
                                                                                <span>La tribu</span>
                                    </a>
                                </li>
                                                            <li class="nav-mobile__item ">
                                    <a href="/elao_/pr/356/blog">
                                                                                <span>Blog</span>
                                    </a>
                                </li>
                                                            <li class="nav-mobile__item nav-mobile__item--large">
                                    <a href="/elao_/pr/356/contact">
                                                                                    <i class="icon icon--contact" aria-hidden="true"></i>
                                                                                <span>Contact</span>
                                    </a>
                                </li>
                                                    </ul>
                    </nav>
                    <button class="nav-toggle nav-toggle--open">
                        <i class="icon icon--hamburger" aria-hidden="true"></i>
                        <span class="screen-reader">Ouvrir le menu</span>
                    </button>
                            </div>
        </header>
        <div class="container">
            <main>
                    <ol class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
        <li class="breadcrumb__item" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="/elao_/pr/356/blog">
                <span itemprop="name">Blog</span>
            </a>
            <meta itemprop="position" content="1" />
        </li>
        <li class="breadcrumb__item"  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
            <a itemprop="item" href="#">
                <span itemprop="name">Plusieurs mailer dans une application Symfony 2</span>
            </a>
            <meta itemprop="position" content="2" />
        </li>
    </ol>

    <div class="article-banner">
        <div class="article-banner__cover" style="background: #f1f1f1 url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/302911ec3d26654131684bcf67cd1224.jpg');
    background: #f1f1f1 -webkit-image-set(
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/302911ec3d26654131684bcf67cd1224.jpg') 1x,
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/3d5bcca8ce1ac1e571044c925d17ea06.jpg') 2x
    );
    background: #f1f1f1 -moz-image-set(
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/302911ec3d26654131684bcf67cd1224.jpg') 1x,
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/3d5bcca8ce1ac1e571044c925d17ea06.jpg') 2x
    );
    background: #f1f1f1 -ms-image-set(
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/302911ec3d26654131684bcf67cd1224.jpg') 1x,
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/3d5bcca8ce1ac1e571044c925d17ea06.jpg') 2x
    );
    background: #f1f1f1 image-set(
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/302911ec3d26654131684bcf67cd1224.jpg') 1x,
        url('/elao_/pr/356/resized/images/posts/thumbnails/mailers.jpg/3d5bcca8ce1ac1e571044c925d17ea06.jpg') 2x
    );" data-aos="fade-down"></div>

        <div class="article-info" data-aos="zoom-in">
                                        <div class="article-author ">
                    <div class="article-author__image">
                                                    <a>
                                <img     src="/elao_/pr/356/resized/images/members/avatars/default.jpg/4a9bd63add7884512b342fbfa283f44a.jpg"
    srcset="
        /elao_/pr/356/resized/images/members/avatars/default.jpg/4a9bd63add7884512b342fbfa283f44a.jpg 1x,
        /elao_/pr/356/resized/images/members/avatars/default.jpg/2d5b44e7ea46a4b9ca0db36f6d849881.jpg 2x
    "
 />
                            </a>
                                            </div>
                    <span class="article-author__info">
                    Écrit par
                                            <a>
                            <strong>Johan Lopes</strong>
                        </a>
                                      </span>
                </div>
                        <div class="article-info__date">
                <span>Publication <strong>11 octobre 2013</strong></span>
                            </div>
        </div>

        <div class="article-header" data-aos="zoom-in-up">
            <h1>Plusieurs mailer dans une application Symfony 2</h1>
            <p>Plusieurs mailer dans une application Symfony 2</p>
            <ul class="article-tag-list">
                                    <li class="article-tag-list__item">
                        <a href="/elao_/pr/356/blog/tag/symfony" rel="nofollow">#Symfony</a>
                    </li>
                                    <li class="article-tag-list__item">
                        <a href="/elao_/pr/356/blog/tag/errornotifierbundle" rel="nofollow">#Errornotifierbundle</a>
                    </li>
                                    <li class="article-tag-list__item">
                        <a href="/elao_/pr/356/blog/tag/swiftmailer" rel="nofollow">#Swiftmailer</a>
                    </li>
                                    <li class="article-tag-list__item">
                        <a href="/elao_/pr/356/blog/tag/mailer-transport" rel="nofollow">#MailerTransport</a>
                    </li>
                            </ul>
        </div>
    </div>

    
    <div class="article-content">
        <main class="article-content__main">

            
            <body><p>Voici une petite astuce que j'ai découvert hier et que j'ai pensé utile de partager !<!--more--></p>
<h1 id="problematique" class="anchor-title"><a href="#problematique">Problématique</a></h1>
<p><strong>Contexte :</strong></p>
<ul>
<li>Votre application Symfony2 utilise un service tiers pour envoyer vos e-mails (comme <a href="https://fr.mailjet.com/" target="_blank">Mailjet</a> par exemple)</li>
<li>Votre application a besoin d'envoyer des e-mails de notifications aux administrateurs lorsque des erreurs se produisent (Erreurs 500 par exemple)<!--more--></li>
</ul>
<p>Imaginez qu’une erreur se produise sur l’une de vos pages et que vous ayez des centaines d’utilisateurs en train de visualiser cette même page.Pour chaque affichage de cette dernière, vous allez recevoir un e-mail de notification.
Si ces e-mails passent par Mailjet par exemple, votre quota fondra à vue d’œil...
Au mieux vous atteindrez une limite de quota et les mails suivants seront bloqués, au pire vous ferez un énorme hors forfait qui pourra vous couter très cher...</p>
<h1 id="solution-proposee" class="anchor-title"><a href="#solution-proposee">Solution proposée</a></h1>
<p>La solution que je vous propose pour palier à cela est de créer 2 mailer utilisant 2 transports différents :</p>
<ul>
<li>Les e-mails classiques destinés aux utilisateurs de votre application passeront par votre serveur SMTP</li>
<li>Les e-mails techniques destinés aux administrateurs de votre application seront envoyés via la fonction mail de votre PHP.</li>
</ul>
<h1 id="mise-en-oeuvre-de-la-solution" class="anchor-title"><a href="#mise-en-oeuvre-de-la-solution">Mise en œuvre de la solution</a></h1>
<p>Pour cela rien de plus simple, créez plusieurs mailers dans votre app/config/config.yml :</p>
<pre class="code-multiline language-yaml"><code class="language-yaml" id="8ed9ff05059474544dd70b097e430e4f"><span class="token comment"># Swiftmailer Configuration</span>
<span class="token key atrule">swiftmailer</span><span class="token punctuation">:</span>
    <span class="token key atrule">default_mailer</span><span class="token punctuation">:</span> default
    <span class="token key atrule">mailers</span><span class="token punctuation">:</span>
        <span class="token key atrule">default</span><span class="token punctuation">:</span>
            <span class="token key atrule">transport</span><span class="token punctuation">:</span> smtp
            <span class="token key atrule">host</span><span class="token punctuation">:</span>      in.mailjet.com
            <span class="token key atrule">username</span><span class="token punctuation">:</span>  mylogin
            <span class="token key atrule">password</span><span class="token punctuation">:</span>  mypassword
        <span class="token key atrule">notifier</span><span class="token punctuation">:</span>
            <span class="token key atrule">transport</span><span class="token punctuation">:</span> mail</code></pre>
<p>Vous remarquerez que cela aura pour effet de créer 2 services d'envoi d'e-mails que vous pourrez ensuite utiliser dans votre application :</p>
<pre class="code-multiline language-bash"><code class="language-bash" id="ff206c37f7781019d1aded89fd684fbe">jlopes:/Volumes/Elao/workspace/myProject ./app/console container:debug <span class="token operator">|</span> <span class="token function">grep</span> mailer
mailer                                            n/a       <span class="token builtin class-name">alias</span> <span class="token keyword">for</span> swiftmailer.mailer.default
swiftmailer.mailer                                n/a       <span class="token builtin class-name">alias</span> <span class="token keyword">for</span> swiftmailer.mailer.default
swiftmailer.mailer.default                        container Swift_Mailer
swiftmailer.mailer.default.plugin.messagelogger   container Swift_Plugins_MessageLogger
swiftmailer.mailer.default.transport              container Swift_Transport_EsmtpTransport
swiftmailer.mailer.notifier                       container Swift_Mailer
swiftmailer.mailer.notifier.plugin.messagelogger  container Swift_Plugins_MessageLogger
swiftmailer.mailer.notifier.transport             container Swift_Transport_MailTransport
<span class="token punctuation">..</span>.</code></pre>
<p>Cette astuce reste très simple mais je n'ai rien trouvé dans la documentation officielle de Symfony qui l'expliquait clairement. Elle peut se révéler très utile lorsque vous utilisez le bundle <strong><a href="https://github.com/Elao/ErrorNotifierBundle" target="_blank">ErrorNotifierBundle</a></strong></p>
<p>Merci et à bientôt !</p></body>
                                                </main>
        <aside class="article-content__aside">
                    </aside>
    </div>

    <div class="article-footer" data-aos="fade-in">
                                    <div class="article-author">
                    <div class="article-author__image">
                        <a>
                            <img     src="/elao_/pr/356/resized/images/members/avatars/default.jpg/4a9bd63add7884512b342fbfa283f44a.jpg"
    srcset="
        /elao_/pr/356/resized/images/members/avatars/default.jpg/4a9bd63add7884512b342fbfa283f44a.jpg 1x,
        /elao_/pr/356/resized/images/members/avatars/default.jpg/2d5b44e7ea46a4b9ca0db36f6d849881.jpg 2x
    "
 />
                        </a>
                    </div>
                    <span class="article-author__info">
                        Écrit par
                        <a>
                            <strong>Johan Lopes</strong>
                        </a>
                    </span>

                    <div class="article-author__social">
                                                    <a href="https://twitter.com/johan_lopes" class="social social--small">
                                <i class="icon icon--twitter" aria-hidden="true"></i>
                                <span class="screen-reader">Compte twitter de Johan Lopes</span>
                            </a>
                                                                            <a href="https://github.com/gfaivre " class="social social--small">
                                <i class="icon icon--github" aria-hidden="true"></i>
                                <span class="screen-reader">Compte github de Johan Lopes</span>
                            </a>
                                                                            <a href="http://www.elao.com" class="social social--small">
                                <i class="icon icon--website" aria-hidden="true"></i>
                                <span class="screen-reader">Site personnel de Johan Lopes</span>
                            </a>
                                            </div>
                </div>
                        </div>

            <div class="bricks">
            
                            <div class="brick-contribute">
                    <p>
                        Une typo ?
                        <a href="https://github.com/Elao/elao_/edit/afup-day-2021-day2/content/blog/dev/plusieurs-mailer-dans-une-application-symfony-2.md/" target="_blank" class="animated-link animated-link--light">
                            Modifier cet article sur Github
                        </a>
                    </p>
                </div>
                    </div>
                </main>
                            <footer class="footer">
    <section class="footer__links">
        <p class="h1">
            elao
            <span>développe</span>
            <span>du lien</span>
        </p>
        <div class="links">
                            <ul>
                                            <li>
                            <a href="/elao_/pr/356/nos-services">Services</a>
                        </li>
                                            <li>
                            <a href="/elao_/pr/356/methodologie">Méthodologie</a>
                        </li>
                                            <li>
                            <a href="/elao_/pr/356/etudes-de-cas">Études de cas</a>
                        </li>
                                    </ul>
                            <ul>
                                            <li>
                            <a href="/elao_/pr/356/nos-valeurs">Valeurs</a>
                        </li>
                                            <li>
                            <a href="/elao_/pr/356/la-tribu">La tribu</a>
                        </li>
                                            <li>
                            <a href="/elao_/pr/356/blog">Blog</a>
                        </li>
                                    </ul>
                            <ul>
                                            <li>
                            <a href="/elao_/pr/356/contact">Contact</a>
                        </li>
                                    </ul>
                        <ul>
                <li>
                                        <a href="/elao_/pr/356/recrutement">
                        Nous recrutons
                                                    <span class="bullet">2</span>
                                            </a>
                </li>
            </ul>
        </div>
        <div class="socials">
            <ul>
                <li>
                    <a href="https://github.com/elao" target="_blank">
                        <i class="icon icon--github"></i>
                        Github
                    </a>
                </li>
                <li>
                    <a href="https://twitter.com/elao" target="_blank">
                        <i class="icon icon--twitter"></i>
                        Twitter
                    </a>
                </li>
                <li>
                    <a href="https://www.instagram.com/hello_elao_/" target="_blank">
                        <i class="icon icon--instagram"></i>
                        Instagram
                    </a>
                </li>
            </ul>
        </div>
    </section>
    <section class="footer__legals">
        <span>© 2005 - 2021 - ELAO - Tous droits réservés</span>
        <a href="/elao_/pr/356/legal">Mentions légales</a>
        <a href="/elao_/pr/356/confidentialite">Protection des données</a>
    </section>
</footer>

                    </div>
            

        </body>
</html>
